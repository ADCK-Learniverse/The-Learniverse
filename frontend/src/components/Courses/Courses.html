<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>Courses</title>-->
<!--</head>-->
<!--<body>-->
<!--  <h1>Courses</h1>-->

<!--  <div id="courses">-->
<!--    &lt;!&ndash; Courses will be dynamically added here &ndash;&gt;-->
<!--  </div>-->

<!--  <script>-->
<!--    // Function to get access token from server-->
<!--    async function getAccessToken(username, password) {-->
<!--      const response = await fetch('http://localhost:8000/token', {-->
<!--        method: 'POST',-->
<!--        headers: {-->
<!--          'Content-Type': 'application/x-www-form-urlencoded'-->
<!--        },-->
<!--        body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`-->
<!--      });-->
<!--      const data = await response.json();-->
<!--      return data.access_token;-->
<!--    }-->

<!--    // Function to fetch courses using access token-->
<!--    async function fetchCourses(token, page, size) {-->
<!--      const response = await fetch(`http://127.0.0.1:8000/courses/all?page=${page}&size=${size}`, {-->
<!--        headers: {-->
<!--          'Authorization': `Bearer ${token}`-->
<!--        }-->
<!--      });-->
<!--      if (!response.ok) {-->
<!--        throw new Error('Network response was not ok');-->
<!--      }-->
<!--      return response.json();-->
<!--    }-->

<!--    // Function to display courses-->
<!--    function displayCourses(courses) {-->
<!--      const coursesDiv = document.getElementById('courses');-->
<!--      courses.forEach(course => {-->
<!--        const courseDiv = document.createElement('div');-->
<!--        courseDiv.classList.add('course');-->
<!--        courseDiv.innerHTML = `-->
<!--          <h2>${course['Course Title']}</h2>-->
<!--          <p>${course.Description}</p>-->
<!--          <p>Rating: ${course.Rating}</p>-->
<!--          <p>Status: ${course.Status}</p>-->
<!--          <p>By: ${course.By}</p>-->
<!--        `;-->
<!--        coursesDiv.appendChild(courseDiv);-->
<!--      });-->
<!--    }-->

<!--    // Main function to fetch and display all courses with pagination-->
<!--    async function main() {-->
<!--      try {-->
<!--        // Check if access token is already stored in local storage-->
<!--        let token = localStorage.getItem('accessToken');-->
<!--        if (!token) {-->
<!--          // Replace 'user1' and 'password1' with actual credentials-->
<!--          token = await getAccessToken('user1', 'password1');-->
<!--          // Store access token in local storage-->
<!--          localStorage.setItem('accessToken', token);-->
<!--        }-->

<!--        let page = 1;-->
<!--        const size = 10;-->
<!--        let hasMoreCourses = true;-->

<!--        while (hasMoreCourses) {-->
<!--          // Fetch courses using access token-->
<!--          const response = await fetchCourses(token, page, size);-->
<!--          const courses = response.Courses; // Extract courses from the response-->
<!--          console.log(`Courses on page ${page}:`, courses); // Log the response for debugging-->

<!--          if (!Array.isArray(courses) || courses.length === 0) {-->
<!--            hasMoreCourses = false;-->
<!--          } else {-->
<!--            displayCourses(courses);-->
<!--            page++;-->
<!--          }-->
<!--        }-->
<!--      } catch (error) {-->
<!--        console.error('There was a problem:', error);-->
<!--      }-->
<!--    }-->

<!--    // Call the main function-->
<!--    main();-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Courses</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #courses {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      width: 80%;
      margin-top: 20px;
    }

    .course {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
    }

    .course:hover {
      transform: scale(1.05);
    }

    .course img {
      max-width: 100%;
      height: auto;
      border-radius: 10px 10px 0 0;
    }

    .course h2 {
      font-size: 1.5em;
      margin: 10px 0;
    }

    .course p {
      margin: 5px 0;
    }
  </style>
</head>
<body>

  <h1>Courses</h1>

  <div id="courses">
    <!-- Courses will be dynamically added here -->
  </div>

  <script>
    // Function to get access token from server
    async function getAccessToken(username, password) {
      const response = await fetch('http://localhost:8000/token', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`
      });
      const data = await response.json();
      return data.access_token;
    }

    // Function to fetch courses using access token
    async function fetchCourses(token, page, size) {
      const response = await fetch(`http://127.0.0.1:8000/courses/all?page=${page}&size=${size}`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    }

    function displayCourses(courses) {
  const coursesDiv = document.getElementById('courses');
  courses.forEach(course => {
    const courseDiv = document.createElement('div');
    courseDiv.classList.add('course');
    courseDiv.innerHTML = `
      <img src="${course.courses}" alt="${course['Course Title']}">
      <h2>${course['Course Title']}</h2>
      <p>${course.Description}</p>
      <p>Rating: ${course.Rating}</p>
      <p>Status: ${course.Status}</p>
      <p>By: ${course.By}</p>
    `;
    coursesDiv.appendChild(courseDiv);
  });
}

    // Main function to fetch and display all courses with pagination
    async function main() {
      try {
        // Check if access token is already stored in local storage
        let token = localStorage.getItem('token');
        if (!token) {
          window.location.href = "/src/components/Login/Login_page.html";
        }

        let page = 1;
        const size = 10;
        let hasMoreCourses = true;

        while (hasMoreCourses) {
          // Fetch courses using access token
          const response = await fetchCourses(token, page, size);
          const courses = response.Courses; // Extract courses from the response
          console.log(`Courses on page ${page}:`, courses); // Log the response for debugging

          if (!Array.isArray(courses) || courses.length === 0) {
            hasMoreCourses = false;
          } else {
            displayCourses(courses);
            page++;
          }
        }
      } catch (error) {
        console.error('There was a problem:', error);
      }
    }

    // Call the main function
    main();
  </script>
</body>
</html>
